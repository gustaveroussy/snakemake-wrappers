.. _`samtools bam2fq separate`:

SAMTOOLS BAM2FQ SEPARATE
========================

Convert a bam file with paired end reads back to unaligned reads in a two separate fastq files with samtools. Reads that are not properly paired are discarded (READ_OTHER and singleton reads in samtools bam2fq documentation), as are secondary (0x100) and supplementary reads (0x800).





Example
-------

This meta-wrapper can be used in the following way:

.. code-block:: python

    rule samtools_bam2fq_separate:
        input:
            "mapped/{sample}.bam"
        output:
            "reads/{sample}.1.fq",
            "reads/{sample}.2.fq"
        params:
            sort = "-m 4G",
            bam2fq = "-n"
        threads:  # Remember, this is the number of samtools' additional threads
            3     # At least 2 threads have to be requested on cluster sumbission.
                  # Thus, this value - 2 will be sent to samtools sort -@ argument.
        wrapper:
            "0.65.0-211-g6a5c5194/bio/samtools/bam2fq/separate"


Note that input, output and log file paths can be chosen freely.
When running with

.. code-block:: bash

    snakemake --use-conda

the software dependencies will be automatically deployed into an isolated environment before execution.



Notes
-----

* Samtools -@/--threads takes one integer as input. This is the number of additional threads and not raw threads.




Authors
-------


* David Laehnemann

* Victoria Sack



Code
----


