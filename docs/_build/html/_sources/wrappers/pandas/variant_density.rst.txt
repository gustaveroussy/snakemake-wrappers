.. _`Variant Density`:

VARIANT DENSITY
===============

Compute and filter based on local variant density





Example
-------

This meta-wrapper can be used in the following way:

.. code-block:: python

    rule test_variant_density:
        input:
            vcf = "in.vcf"
        output:
            vcf = "filtered.vcf"
        message:
            "Testing variant density filter"
        threads:
            1
        resources:
            mem_mb = (
                lambda wildcards, attempt: min(attempt * 1024, 10240)
            ),
            time_min = (
                lambda wildcards, attempt: min(attempt * 20, 200)
            )
        params:
            filter_vcf = False
        log:
            "logs/test_variant_density.log"
        wrapper:
            "0.65.0-211-g6a5c5194/bio/pandas/variant_density"


Note that input, output and log file paths can be chosen freely.
When running with

.. code-block:: bash

    snakemake --use-conda

the software dependencies will be automatically deployed into an isolated environment before execution.



Notes
-----

The VCF is assumed to be sorted.

Parameters:

* window_size (int): The genomic range used to compute variant density. *Default: 150*
* update_header (bool): Add the filtering information in the header. *Default: true.*
* update_info (bool): Add density information in the info column. *Default: true.*
* filter_vcf (bool): Remove the variants in a region which density is below the provided threshold. *Default: false.*




Authors
-------


* Thibault Dayris



Code
----


