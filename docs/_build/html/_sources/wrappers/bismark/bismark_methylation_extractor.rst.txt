.. _`bismark_methylation_extractor`:

BISMARK_METHYLATION_EXTRACTOR
=============================

Call methylation counts from Bismark alignment results (see https://github.com/FelixKrueger/Bismark/blob/master/bismark_methylation_extractor).






Example
-------

This meta-wrapper can be used in the following way:

.. code-block:: python

    rule bismark_methylation_extractor:
        input: "bams/{sample}.bam"
        output:
            mbias_r1="qc/meth/{sample}.M-bias_R1.png",
            # Only for PE BAMS:
            # mbias_r2="qc/meth/{sample}.M-bias_R2.png",

            mbias_report="meth/{sample}.M-bias.txt",
            splitting_report="meth/{sample}_splitting_report.txt",

            # 1-based start, 1-based end ('inclusive') methylation info: % and counts
            methylome_CpG_cov="meth_cpg/{sample}.bismark.cov.gz",
            # BedGraph with methylation percentage: 0-based start, end exclusive
            methylome_CpG_mlevel_bedGraph="meth_cpg/{sample}.bedGraph.gz",

            # Primary output files: methylation status at each read cytosine position: (extremely large)
            read_base_meth_state_cpg="meth/CpG_context_{sample}.txt.gz",
            # * You could merge CHG, CHH using: --merge_non_CpG
            read_base_meth_state_chg="meth/CHG_context_{sample}.txt.gz",
            read_base_meth_state_chh="meth/CHH_context_{sample}.txt.gz"
        log:
            "logs/meth/{sample}.log"
        params:
            output_dir="meth",  # optional output dir
            extra="--gzip --comprehensive --bedGraph"  # optional params string
        wrapper:
            "0.65.0-211-g6a5c5194/bio/bismark/bismark_methylation_extractor"


Note that input, output and log file paths can be chosen freely.
When running with

.. code-block:: bash

    snakemake --use-conda

the software dependencies will be automatically deployed into an isolated environment before execution.




Authors
-------


* Roman Cherniatchik



Code
----


