rule gatk_callableloci_wts:
	input:
		bam = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_markdup.temp.bam",
		bai = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_markdup.temp.bam.bai"
	output:
		summary = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_callableloci.table.txt",
		bed = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_callableloci.bed"
	resources: io=2
	log:
		"{basedir}/{analysis}/log/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_callableloci.log"
	params:
		reference = config["general_informations"]["FASTA_FILE"],
		gatk_callableloci_options = config["gatk_callableloci_wts"]["OPTIONS"]
	shell:
		'java -Xmx11500m -Xms11500m -XX:ParallelGCThreads=2 -XX:+AggressiveHeap -jar /usr/share/java/GenomeAnalysisTK.jar -T CallableLoci {params.gatk_callableloci_options} -I {input.bam} -R {params.reference} -o {output.bed} -summary {output.summary} -L /data/annotations/Human/GRCh38/DB/custom/Twist_Bioscience/Merge_CORE-SPIKE_GRCh38.{wildcards.index}.merged.bed  2>&1 | tee -a {log}'
