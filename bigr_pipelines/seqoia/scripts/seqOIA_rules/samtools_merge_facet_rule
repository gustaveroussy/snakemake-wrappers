rule samtools_merge_facet:
	input:
                lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_bqsr.bam", analysis=wildcards.analysis, prefix=wildcards.prefix, index=facet)
	output:
		temp("{basedir}/{analysis}/{prefix}/{prefix}_facet_merged.bam")
	resources: io=3
	log:
        	"{basedir}/{analysis}/log/{prefix}/{prefix}__samtools_merge_facet.log"
	params:
		samtools_merge_options = config["samtools_merge_facet"]["OPTIONS"]
	shell:
		"set -o pipefail; samtools merge {params.samtools_merge_options} {output} {input} 2>&1 | tee -a {log}"
