rule snpsift_dbnsfp_trio_wgs:
	input:
		"{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_snpeff.vcf"
	output:
		temp("{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_snpsift_dbnsfp.vcf")
	log:
		"{basedir}/{analysis}/log/chr_{index}/{analysis}_chr_{index}_snpsift_dbnsfp.log"
	params:
		database=config["snpsift_dbnsfp"]["DATABASE"],
		snpsift_dbnsfp_options=config["snpsift_dbnsfp"]["OPTIONS"]
	shell:
		"""
				singularity exec -B /mnt/beegfs/database/bioinfo/seqoia:/mnt/beegfs/database/bioinfo/seqoia -B /mnt/beegfs/scratch/:/mnt/beegfs/scratch/ -B /mnt/beegfs/pipelines/sandbox_dir/seqoia/original/seqoia_cancer-main:/mnt/beegfs/pipelines/sandbox_dir/seqoia/original/seqoia_cancer-main /mnt/beegfs/software/seqoia/singularity/snpeff_snpsift_4.3t-1.sif bash -c "java -Xmx7500m -Xms7500m -XX:ParallelGCThreads=1 -XX:+AggressiveHeap -jar /usr/share/java/SnpSift.jar dbnsfp -c /etc/snpeff/snpEff.config -db {params.database} {params.snpsift_dbnsfp_options} {input} 2>&1 1> {output} | tee -a {log}"
		"""
