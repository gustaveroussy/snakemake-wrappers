rule snpsift_phastcons_trio_wgs:
    input:
        "{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_snpsift_annotate_leaves.vcf"
    output:
        temp("{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_snpsift_phastcons.vcf")
    log:
        "{basedir}/{analysis}/log/chr_{index}/{analysis}_chr_{index}_snpsift_phastcons.log"
    params:
        database=config["snpsift_phastcons"]["DATABASE"],
        snpsift_phastcons_options=config["snpsift_phastcons"]["OPTIONS"]
    shell:
        """
				singularity exec -B /mnt/beegfs/database/bioinfo/seqoia:/mnt/beegfs/database/bioinfo/seqoia -B /mnt/beegfs/scratch/:/mnt/beegfs/scratch/ /mnt/beegfs/software/seqoia/singularity/snpeff_snpsift_4.3t-1.sif bash -c "java -Xmx7500m -Xms7500m -XX:ParallelGCThreads=1 -XX:+AggressiveHeap -jar /usr/share/java/SnpSift.jar phastcons -c /etc/snpeff/snpEff.config {params.database} {params.snpsift_phastcons_options} {input} 2>&1 1> {output} | tee -a {log}"
        """
