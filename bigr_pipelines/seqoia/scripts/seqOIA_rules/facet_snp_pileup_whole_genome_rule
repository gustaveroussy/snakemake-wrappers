rule facet_snp_pileup_whole_genome:
	input:
		bam_T = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/{prefix}_facet_merged.bam", basedir=basedir, analysis=wildcards.analysis, prefix = wgs_tumor),
		bam_C = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/{prefix}_facet_merged.bam", basedir=basedir, analysis=wildcards.analysis, prefix = wgs_constit)
	output:
		temp("{basedir}/{analysis}/Facet/{analysis}_facet_pileup.txt.gz")
	log:
		"{basedir}/{analysis}/log/Facet/{analysis}_facet_pileup.log"
	resources: io = 3
	params:
		facet_pileup_options = config["facet_snp_pileup_genome"]["OPTIONS"],
		dbsnp = config["facet_snp_pileup_genome"]["DATABASE"]
	shell:
		"""
		singularity exec -B /mnt/beegfs/database/bioinfo/seqoia:/mnt/beegfs/database/bioinfo/seqoia -B /mnt/beegfs/scratch/:/mnt/beegfs/scratch/ -B /mnt/beegfs/pipelines/sandbox_dir/seqoia/singularity/seqoia_cancer-main:/mnt/beegfs/pipelines/sandbox_dir/seqoia/singularity/seqoia_cancer-main /mnt/beegfs/software/seqoia/singularity/facets_0.5.14-1.sif bash -c "snp-pileup {params.facet_pileup_options} {params.dbsnp} {output} {input.bam_C} {input.bam_T} 2>&1 | tee -a {log}"
		"""