rule fusion_csv_modification:
	input:
		fusion_inspector = "{basedir}/{analysis}/{sample}/star_fusion/fusion_inspector/{sample}.FusionInspector.fusions.abridged.tsv.coding_effect",
		arriba = "{basedir}/{analysis}/{sample}/Arriba/{sample}_arriba_fusion.tsv",
		catcher = "{basedir}/{analysis}/{sample}/fusion_catcher/final-list_candidate-fusion-genes.txt",
		star = "{basedir}/{analysis}/{sample}/star_fusion/star-fusion.fusion_predictions.abridged.tsv",
		script_python = lambda wildcards: expand("{script_dir}/CNV_fusion_modificator.py", script_dir=script_dir)
	output:
		"{basedir}/{analysis}/{sample}/star_fusion/fusion_inspector/{sample}.FusionInspector.fusions.abridged.coding_effect.final.tsv",
	params:
		mercury = config["CNV_FUSION_modificator"]["mercury"],
		curie = config["CNV_FUSION_modificator"]["curie"],
		gene_census = config["CNV_FUSION_modificator"]["gene_census"]
	log:
		"{basedir}/{analysis}/log/{sample}_Fusion_modificator.log"
	shell:
		"python3 {input.script_python} --fusion_inspector_file {input.fusion_inspector} --arriba_file {input.arriba} --fusion_catcher_file {input.catcher} --star_file {input.star} -m {params.mercury} -c {params.curie} -g {params.gene_census} 2>&1 | tee -a {log}"
