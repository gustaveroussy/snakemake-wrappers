rule signature_mut_matrix_decomp:
	input:
		py_file = expand("{script_dir}/signatures_mut/SigProfile_MatrixDecompose_200429.py",script_dir=script_dir),
		folder = ancient("{basedir}/{analysis}/{prefix}/sign_mut/Res/")
	output:
		decomp_DBS78 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_DBS78_Decomposed/Signature_plotDBS_78_plots_Deconvolution_DBS78_Decomposed.pdf",
		act_DBS78 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_DBS78_Decomposed/Deconvolution_DBS78_Decomposed_Activities_Plot_SBS78.pdf",
		decomp_ID83 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_ID83_Decomposed/Signature_plotID_83_plots_Deconvolution_ID83_Decomposed.pdf",
		act_ID83 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_ID83_Decomposed/Deconvolution_ID83_Decomposed_Activities_Plot_SBS83.pdf",
		decomp_SB96 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_SB96_Decomposed/Signature_plotSBS_96_plots_Deconvolution_SB96_Decomposed.pdf",
		act_SB96 = "{basedir}/{analysis}/{prefix}/sign_mut/Res/Deconvolution_SB96_Decomposed/Deconvolution_SB96_Decomposed_Activities_Plot_SBS96.pdf"
	log:
		"{basedir}/{analysis}/log/sign_mut_decompose.log"
	shell:
		"python3 {input.py_file} {input.folder} 2>&1 | tee -a {log}"
