rule picard_collect_hsmetrics_wes:
	input:
		bam = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.temp.bam"
	output:
		txt = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_hsmetrics.txt"
	resources: io=2
	log:
		"{basedir}/{analysis}/log/{prefix}/chr_{index}/{prefix}_chr_{index}_hsmetrics.log"
	params:
		picard_collect_hsmetrics_options = config["picard_collect_hsmetrics"]["OPTIONS"],
		reference=config["general_informations"]["FASTA_FILE"],
	shell:
		"java -Xmx8000m -Xms8000m -XX:ParallelGCThreads=2 -XX:+AggressiveHeap -jar /usr/share/java/gatk-package-4.1.0.0-local.jar CollectHsMetrics {params.picard_collect_hsmetrics_options} -I {input.bam} -O {output.txt} -R {params.reference} -BI /data/annotations/Human/GRCh38/DB/custom/Twist_Bioscience/sorted_primary_assemblies/Merge_CORE-SPIKE_GRCh38.{wildcards.index}.interval_list -TI /data/annotations/Human/GRCh38/DB/custom/Twist_Bioscience/sorted_primary_assemblies/Merge_CORE-SPIKE_GRCh38.{wildcards.index}.interval_list 2>&1 | tee -a {log}"

