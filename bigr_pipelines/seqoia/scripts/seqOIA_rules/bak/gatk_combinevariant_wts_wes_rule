rule gatk_combinevariant_wts_wes:
        input:
                vcf_wts = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_wts_VTN.vcf",  basedir=basedir, analysis=wildcards.analysis,prefix=wts,index=wildcards.index),
                vcf_wgs = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_VTN.vcf",  basedir=basedir, analysis=wildcards.analysis,prefix=wgs_constit,index=wildcards.index),
                vcf_mutect_wes = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_snpsift_annotated_wes.vcf",  basedir=basedir, analysis=wildcards.analysis,prefix=wes_tumor,index=wildcards.index)
        output:
                temp("{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_genotype.vcf")
        log:
                "{basedir}/{analysis}/log/chr_{index}/{analysis}_chr_{index}_combinevariant_wts_wes_database.log"
        resources: io=50
        params:
                reference = config["general_informations"]["FASTA_FILE"],
                gatk_combinevariant_options = config["gatk_combinevariant"]["OPTIONS"]
        shell:
                'java -Xmx11500m -Xms11500m -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -jar /usr/share/java/GenomeAnalysisTK.jar -T CombineVariants {params.gatk_combinevariant_options} -R {params.reference} --variant {input.vcf_wgs} --variant {input.vcf_mutect_wes} --variant {input.vcf_wts} -o {output} 2>&1 | tee -a {log}'
