rule export_irods_CNV:
	input:
		annotSV = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/{prefix}_CNVnator.annotated.final.tsv", basedir=basedir, analysis=wildcards.analysis, prefix=proband),
		plot_CNVnator_chr = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/graphs/{prefix}_chr_{index}_cnvnator.png", basedir=basedir, analysis=wildcards.analysis, prefix=proband, index=index_cnv),
		instanSV = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/instanSV/{prefix}_instanSV.pdf", basedir=basedir, analysis=wildcards.analysis, prefix=proband),
		samplot = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/samplot/",basedir=basedir, analysis=wildcards.analysis, prefix=proband),
		samplot_trio = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/samplot_chr_{index}.done", basedir=basedir, analysis=wildcards.analysis, prefix=proband, index=index_cnv),
		tsv = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/CNVnator/{prefix}_CNVnator.annotated.final.tsv", basedir=basedir, analysis=wildcards.analysis, prefix=proband)
	output:
		flag = "{export_dir}/{analysis}/CNV_export.done",
		CNVnator = "{export_dir}/{analysis}/CNV/CNVnator/",
		samplot = "{export_dir}/{analysis}/CNV/samplot/",
		folder = "{export_dir}/{analysis}/CNV/"
	resources: io = 35
	log:
		basedir+"/{analysis}/log/{analysis}_export_CNV_irods.log"
	shell:
		"mkdir -p {output.samplot} && rsync -Paz {input.samplot} {output.samplot} && mkdir -p {output.CNVnator} && rsync -Paz {input.plot_CNVnator_chr} {output.CNVnator} && rsync -Paz {input.tsv} {output.CNVnator} && rsync -Paz {input.instanSV} {output.folder} && touch {output.flag} 2>&1 | tee -a {log}"
