rule bcftools_mendelian_error:
	input:
		"{basedir}/{analysis}/mendelian/{analysis}_bcftools_mendelian_missing_geno.vcf"
	output:
		vcf = "{basedir}/{analysis}/mendelian/{analysis}_bcftools_mendelian_result.vcf",
		txt = "{basedir}/{analysis}/mendelian/{analysis}_bcftools_mendelian_value.txt"
	log:
		"{basedir}/{analysis}/log/mendelian/{analysis}_bcftools_mendelian.log"
	params:
		father = config["general_informations"]["FATHER"],
		mother = config["general_informations"]["MOTHER"],
		proband = config["general_informations"]["PROBAND"],
		bcftools_options = config["bcftools_mendelian"]["OPTIONS"]
	run:
		pere = params.father
		mere = params.mother
		prob = params.proband
		vcf = output
		Flag = False
		if pere != "FATHER" and mere != "MOTHER" and prob != "PROBAND":
			Flag = True
		else:
			cmd = "echo NO-FAMILY > {output.vcf} && echo NO-FAMILY > {output.txt}"
			shell(cmd)
		if Flag == True:
			cmd = "set -o pipefail; bcftools +mendelian {params.bcftools_options} {input} -t {params.mother},{params.father},{params.proband} -o {output.vcf} 2> {output.txt}"
			shell(cmd)
