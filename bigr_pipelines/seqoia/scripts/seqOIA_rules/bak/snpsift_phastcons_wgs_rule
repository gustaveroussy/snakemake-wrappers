rule snpsift_phastcons_wgs:
    input:
        "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_snpsift_annotate_leaves.vcf"
    output:
        temp("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_snpsift_phastcons.vcf")
    log:
        "{basedir}/{analysis}/log/{prefix}/chr_{index}/{prefix}_chr_{index}_snpsift_phastcons.log"
    params:
        database=config["snpsift_phastcons"]["DATABASE"],
        snpsift_phastcons_options=config["snpsift_phastcons"]["OPTIONS"]
    shell:
        "java -Xmx7500m -Xms7500m -XX:ParallelGCThreads=1 -XX:+AggressiveHeap -jar /usr/share/java/SnpSift.jar phastcons -c /etc/snpeff/snpEff.config {params.database} {params.snpsift_phastcons_options} {input} 2>&1 1> {output} | tee -a {log}"
