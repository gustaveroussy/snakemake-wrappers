rule sambamba_merge_CNVnator:
	input:
		lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_bqsr.bam", basedir=basedir, analysis=wildcards.analysis, prefix=wildcards.prefix, index=index)
	output:
		"{basedir}/{analysis}/{prefix}/{prefix}_cnvnator_merged.bam"
	resources: io=3
	log:
		"{basedir}/{analysis}/log/{prefix}/{prefix}_sambamba_merge_cnvnator.log"
	params:
		sambamba_merge_options = config["sambamba_merge_cnvnator"]["OPTIONS"]
	shell:
		"sambamba merge {params.sambamba_merge_options} {output} {input} 2>&1 | tee -a {log}"
