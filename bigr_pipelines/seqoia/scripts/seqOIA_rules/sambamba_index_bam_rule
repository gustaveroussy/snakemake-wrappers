rule sambamba_index_bam:
	input:
		bam = "{basedir}/{analysis}/{sample}/Arriba/Aligned.sortedByCoord.out.bam"
	output:
		bai = temp("{basedir}/{analysis}/{sample}/Arriba/Aligned.sortedByCoord.out.bam.bai")
	log:
		"{basedir}/{analysis}/log/{sample}/{sample}_sambamba_index.log"
	params:
		sambamba_index_options = config["sambamba_index_bam"]["OPTIONS"]
	shell:
		"""
		singularity exec -B /mnt/beegfs/database/bioinfo/seqoia:/mnt/beegfs/database/bioinfo/seqoia -B /mnt/beegfs/scratch/:/mnt/beegfs/scratch/ /mnt/beegfs/software/seqoia/singularity/sambamba_0.7.1-static.sif bash -c "sambamba index {params.sambamba_index_options} {input.bam} 2>&1 | tee -a {log}"
		"""
