rule export_irods_bam_wgs:
	input:
		vcf = lambda wildcards: expand("{basedir}/{analysis}/{analysis}_final_temp.vcf",basedir=basedir, analysis=wildcards.analysis),
		bam = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.temp.bam", prefix=wildcards.prefix,index=wildcards.index, basedir=basedir, analysis=wildcards.analysis),
		bai = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.temp.bam.bai", prefix=wildcards.prefix,index=wildcards.index, basedir=basedir, analysis=wildcards.analysis)
	output:
		bam = "{export_dir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.bam",
		bai = "{export_dir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.bam.bai"
	resources: io = 10
	log:
		basedir+"/{analysis}/log/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup_export_bam_irods.log"
	shell:
		"rsync -Paz {input.bam} {output.bam} && rsync -Paz {input.bai} {output.bai} 2>&1 | tee -a {log}"
