rule arriba_normalization:
	input:
		tsv = "{basedir}/{analysis}/{sample}/Arriba/{sample}_arriba_fusion.tsv",
		py = expand("{script_dir}/Parseur_output_200218.py", script_dir=script_dir)
	output:
		temp = temp("{basedir}/{analysis}/{sample}/Arriba/{sample}_arriba_fusion_normalized_temp.tsv"),
		normalized = temp("{basedir}/{analysis}/{sample}/Arriba/{sample}_arriba_fusion_normalized.tsv")
	log:
		"{basedir}/{analysis}/log/{sample}/{sample}_arriba_normalization.log"
	shell:
		"""
		singularity exec -B /mnt/beegfs/database/bioinfo/seqoia:/mnt/beegfs/database/bioinfo/seqoia -B /mnt/beegfs/scratch/:/mnt/beegfs/scratch/ -B /mnt/beegfs/pipelines/sandbox_dir/seqoia/singularity/seqoia_cancer-main:/mnt/beegfs/pipelines/sandbox_dir/seqoia/singularity/seqoia_cancer-main /mnt/beegfs/software/seqoia/singularity/python3-pyvcf_0.6.8-1.sif bash -c "python3 {input.py} {input.tsv} {output.temp} && sort {output.temp} | uniq > {output.normalized} 2>&1 | tee -a {log}"
		"""
