rule gatk_genomicsDBimport_wgs:
	input:
		gvcf = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}.g.vcf",  basedir=basedir, analysis = wildcards.analysis,prefix=prefix,index=wildcards.index),
		idx = lambda wildcards: expand("{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}.g.vcf.idx",  basedir=basedir, analysis = wildcards.analysis,prefix=prefix,index=wildcards.index)
	output:
		temp("{basedir}/{analysis}/chr_{index}/{analysis}_chr_{index}_database")
	log:
		"{basedir}/{analysis}/log/chr_{index}/{analysis}_chr_{index}_database.log"
	resources: io=1
        params:
		files = lambda wildcards, input: " -V ".join(input.gvcf),
		reference = config["general_informations"]["FASTA_FILE"],
		gatk_genomicsDBimport_options = config["gatk_genomicsDBImport"]["OPTIONS"]
	shell:
		'java -Xmx11500m -Xms11500m -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -jar /usr/share/java/GenomeAnalysisTK.jar GenomicsDBImport {params.gatk_genomicsDBimport_options} -V {params.files} --genomicsdb-workspace-path {output} --reader-threads 3 --intervals {wildcards.index}  2>&1 | tee -a {log}'
