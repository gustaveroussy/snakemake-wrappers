rule picard_collect_insert_size_metrics_wgs:
	input:
		"{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_markdup.temp.bam"
	output:
		txt = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_size_metrics.txt",
                pdf = "{basedir}/{analysis}/{prefix}/chr_{index}/{prefix}_chr_{index}_size_metrics.pdf",
		
	resources: io=10
	log:
		"{basedir}/{analysis}/log/{prefix}/chr_{index}/{prefix}_chr_{index}_picard_collect_insert_size_metrics.log"
	params:
		picard_collect_insert_size_metrics_options = config["picard_collect_insert_size_metrics"]["OPTIONS"],
		reference = config["general_informations"]["FASTA_FILE"]
	shell:
		"java -Xmx3500m -Xms3500m -XX:ParallelGCThreads=3 -XX:+AggressiveHeap -jar /usr/share/java/picard.jar CollectInsertSizeMetrics {params.picard_collect_insert_size_metrics_options} INPUT={input} REFERENCE_SEQUENCE={params.reference} OUTPUT={output.txt} HISTOGRAM_FILE={output.pdf} 2>&1 | tee -a {log}"

